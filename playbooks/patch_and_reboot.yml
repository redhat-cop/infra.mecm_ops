---
- name: Execute Windows patch and reboot operations
  hosts: all
  gather_facts: true
  roles:
    - role: patch_and_reboot

  tasks:
    - name: Show patch and reboot operation results
      ansible.builtin.debug:
        msg:
          - "Patch and Reboot Operation Completed"
          - "Report Name: {{ patch_and_reboot_present_facts.report_name }}"
          - "Report Path: {{ patch_and_reboot_present_facts.report_path }}"
          - "Generated: {{ patch_and_reboot_present_facts.timestamp }}"
          - "Operation Summary:"
          - "  - Total Hosts: {{ patch_and_reboot_present_facts.operation_summary.total_hosts }}"
          - "  - Successful Hosts: {{ patch_and_reboot_present_facts.operation_summary.successful_hosts }}"
          - "  - Failed Hosts: {{ patch_and_reboot_present_facts.operation_summary.failed_hosts }}"
          - "  - Target Hosts: {{ patch_and_reboot_present_facts.target_hosts | join(', ') }}"
          - "Delivery:"
          - "  - File Saved: {{ patch_and_reboot_present_facts.file_saved }}"
          - "  - Email Sent: {{ patch_and_reboot_present_facts.email_sent }}"
